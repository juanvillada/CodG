# This algorithm calculates the p-value of the Chi-square test.
# The test is applied over the rows (59 codons; n=59; DF=58) 
# as a function of the position in the Z-squared matrix. 
# Then the bonferroni corection is applied.

##################################################################################
############################## INPUTS ############################################
##################################################################################
j_matrix_squared <- read.csv("Z-squared_matrix.csv")
##################################################################################
##################################################################################


################################################################################
############################## FUNCTIONS #######################################
################################################################################
X2 <- rowSums(j_matrix_squared)
p_value_58 <- (1-(pchisq(X2, df=58)))
p_adjusted_58 <- p.adjust(p_value_58, method = "bonferroni")
df_pvalues <- data.frame(p_value_58,p_adjusted_58)
################################################################################
################################################################################



##################################################################################
############################## OUTPUT ############################################
##################################################################################
write.csv(df_pvalues, "p-values_ChiSquare_test.csv")
################################################################################
################################################################################
