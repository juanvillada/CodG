# This algorithm calculates the p-value of the 
# two sided Wilcoxon (Mann-Whitney) test, 
# testing two samples: A bin containing the vector of Z-square values
# and the subsequent bin. The fisrt resultant value of the "test" vector
# is the p-value of the test between Bin 1 and Bin 2, the second
# value is the p-value of the test between Bin 2 and Bin 3, etc.


##################################################################################
############################## INPUTS ############################################
##################################################################################
mean_matrix <- read.csv(file = "Expected.csv")[-1]
var_matrix <- read.csv(file = "Var.csv")[-1]
Observed_matrix <- read.csv(file = "Observed_pdCUB.csv")[-1]
Z_squared <- ((Observed_matrix - mean_matrix)^2) / var_matrix
##################################################################################
##################################################################################

##################################################################################
############################## BOXPLOT ###########################################
##################################################################################
boxplot(Z_squared)
##################################################################################
##################################################################################


##################################################################################
############################## WILCOXON TEST #####################################
##################################################################################
test <- vector()
for (i in 1:9){
  test[i] <- wilcox.test(Z_squared[,i], Z_squared[,i+1])[[3]]
  
}
##################################################################################
##################################################################################


##################################################################################
############################## OUTPUT ############################################
##################################################################################
# OUTPUT: "test" vector of p-values
write.csv(test, "p-value_wilcox_test.csv")
##################################################################################
##################################################################################
